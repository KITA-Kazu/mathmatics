<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ï¼‘æ¬¡ä¸å®šæ–¹ç¨‹å¼ã«å‘ã‹ã†ãŸã‚ã®åŸºç¤åŠ›ã‚¢ãƒƒãƒ—ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kosugi+Maru&display=swap');

        body {
            font-family: 'Kosugi Maru', sans-serif;
            background: linear-gradient(135deg, #f06d06, #f7d63d, #6ef780, #3de0f7);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.7);
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container {
            background-color: rgba(255, 255, 255, 0.9);
            padding: 30px 50px;
            border-radius: 25px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 800px;
            width: 90%;
            backdrop-filter: blur(5px);
            border: 3px solid #ffcc00;
        }

        h1 {
            color: #e94e77;
            font-size: 2.5em;
            margin-bottom: 30px;
            position: relative;
            animation: bounceIn 1s ease-out;
            text-shadow: 3px 3px 5px rgba(0,0,0,0.2);
        }

        h1::after {
            content: 'âœ¨';
            position: absolute;
            top: -10px;
            right: -20px;
            font-size: 0.8em;
            transform: rotate(20deg);
        }

        .category-buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }

        .category-button {
            background-color: #ffd166;
            color: #fff;
            border: none;
            border-radius: 15px;
            padding: 20px 30px;
            font-size: 1.3em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            width: calc(33% - 20px);
            min-width: 250px;
            box-sizing: border-box;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .category-button:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.2);
            background-color: #ffb74d;
        }

        .category-button.completed {
            background-color: #7ed957; /* å®Œäº†æ™‚ã®è‰² */
            cursor: default;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1), inset 0 0 10px rgba(255,255,255,0.5);
        }

        .category-button.completed:hover {
            transform: none;
            background-color: #7ed957;
        }

        .quiz-section {
            display: none;
            background-color: #fce4ec;
            padding: 30px;
            border-radius: 20px;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            border: 2px dashed #ff80ab;
        }

        .quiz-section h2 {
            color: #e94e77;
            margin-bottom: 25px;
            font-size: 1.8em;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
        }

        .question {
            font-size: 1.4em;
            margin-bottom: 25px;
            color: #555;
            text-align: left;
        }

        .options label {
            display: block;
            background-color: #ffe082;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
            font-size: 1.1em;
            color: #444;
            border: 1px solid #ffcc80;
        }

        .options label:hover {
            background-color: #ffd54f;
            transform: translateX(5px);
        }

        .options input[type="radio"] {
            margin-right: 10px;
            transform: scale(1.3);
            vertical-align: middle;
        }

        .quiz-navigation {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
        }

        .quiz-navigation button {
            background-color: #81c784;
            color: #fff;
            border: none;
            border-radius: 10px;
            padding: 12px 25px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }

        .quiz-navigation button:hover {
            background-color: #66bb6a;
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        #check-answer-btn {
            background-color: #ff8a65;
        }
        #check-answer-btn:hover {
            background-color: #ff7043;
        }

        #back-to-categories {
            background-color: #90a4ae;
        }
        #back-to-categories:hover {
            background-color: #78909c;
        }

        .result-message {
            font-size: 1.5em;
            color: #e91e63;
            margin-top: 20px;
            font-weight: bold;
            animation: fadeInScale 1s ease-out;
            text-shadow: 2px 2px 3px rgba(0,0,0,0.1);
        }

        .explanation {
            background-color: #e3f2fd;
            border-left: 5px solid #2196f3;
            padding: 15px;
            margin-top: 20px;
            text-align: left;
            font-size: 1.1em;
            color: #333;
            line-height: 1.6;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .explanation strong {
            color: #1976d2;
        }

        #final-message {
            font-size: 3em;
            color: #4CAF50;
            margin-top: 50px;
            font-weight: bold;
            display: none;
            animation: tada 1.5s ease infinite;
            text-shadow: 4px 4px 6px rgba(0,0,0,0.3);
            position: relative;
        }
        #final-message::before, #final-message::after {
            content: 'ğŸ‰';
            position: absolute;
            font-size: 0.6em;
            animation: floatUpDown 2s ease-in-out infinite;
        }
        #final-message::before { left: -40px; top: 0; }
        #final-message::after { right: -40px; bottom: 0; animation-delay: 0.5s; }


        @keyframes bounceIn {
            0%, 20%, 40%, 60%, 80%, 100% {
                -webkit-animation-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
                animation-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
            }
            0% {
                opacity: 0;
                -webkit-transform: scale3d(.3, .3, .3);
                transform: scale3d(.3, .3, .3);
            }
            20% {
                -webkit-transform: scale3d(1.1, 1.1, 1.1);
                transform: scale3d(1.1, 1.1, 1.1);
            }
            40% {
                -webkit-transform: scale3d(.9, .9, .9);
                transform: scale3d(.9, .9, .9);
            }
            60% {
                opacity: 1;
                -webkit-transform: scale3d(1.03, 1.03, 1.03);
                transform: scale3d(1.03, 1.03, 1.03);
            }
            80% {
                -webkit-transform: scale3d(.97, .97, .97);
                transform: scale3d(.97, .97, .97);
            }
            100% {
                opacity: 1;
                -webkit-transform: scale3d(1, 1, 1);
                transform: scale3d(1, 1, 1);
            }
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes tada {
            0% { transform: scale(1); }
            10% { transform: scale(0.9) rotate(-3deg); }
            20% { transform: scale(0.9) rotate(-3deg); }
            30% { transform: scale(1.1) rotate(3deg); }
            40% { transform: scale(1.1) rotate(-3deg); }
            50% { transform: scale(1.1) rotate(3deg); }
            60% { transform: scale(1.1) rotate(-3deg); }
            70% { transform: scale(1.1) rotate(3deg); }
            80% { transform: scale(1.1) rotate(-3deg); }
            90% { transform: scale(1.1) rotate(3deg); }
            100% { transform: scale(1); }
        }

        @keyframes floatUpDown {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

    </style>
</head>
<body>
    <div class="container">
        <h1>ï¼‘æ¬¡ä¸å®šæ–¹ç¨‹å¼ã«å‘ã‹ã†ãŸã‚ã®åŸºç¤åŠ›ã‚¢ãƒƒãƒ—ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</h1>

        <div class="category-buttons">
            <button class="category-button" data-category="moji" id="btn-moji">â‘  æ–‡å­—å¼ãƒ»æ–¹ç¨‹å¼ã®æ‰±ã„æ–¹</button>
            <button class="category-button" data-category="hi" id="btn-hi">â‘¡ æ¯”ã¨æ¯”ä¾‹ã®ç†è§£</button>
            <button class="category-button" data-category="seisu" id="btn-seisu">â‘¢ æ•´æ•°ã®æ€§è³ª</button>
        </div>

        <div id="quiz-section" class="quiz-section">
            <h2 id="quiz-title"></h2>
            <div id="question-area">
                <p class="question" id="current-question"></p>
                <div class="options" id="options-area">
                    <!-- Options will be loaded here by JavaScript -->
                </div>
            </div>
            <p id="result-message" class="result-message"></p>
            <div id="explanation-area" class="explanation" style="display: none;">
                <!-- Explanation will be loaded here by JavaScript -->
            </div>
            <div class="quiz-navigation">
                <button id="check-answer-btn">è§£ç­”ã™ã‚‹</button>
                <button id="next-question-or-retry" style="display: none;">æ¬¡ã®å•é¡Œã¸</button>
                <button id="back-to-categories">ã‚«ãƒ†ã‚´ãƒªãƒ¼ã«æˆ»ã‚‹</button>
            </div>
        </div>

        <p id="final-message">Now, you're ready! ğŸ‰</p>
    </div>

    <script>
        const categories = {
            moji: {
                title: "â‘  æ–‡å­—å¼ãƒ»æ–¹ç¨‹å¼ã®æ‰±ã„æ–¹",
                questions: [
                    { q: "x - 5 = 12 ã‚’è§£ããªã•ã„ã€‚", options: ["x = 7", "x = 17", "x = -7", "x = -17"], answer: 1, explanation: "æ–¹ç¨‹å¼ã¯ä¸¡è¾ºã«åŒã˜æ•°ã‚’è¶³ã—ãŸã‚Šå¼•ã„ãŸã‚Šã—ã¦ã‚‚æˆã‚Šç«‹ã¡ã¾ã™ã€‚x - 5 = 12 ã®ä¸¡è¾ºã«5ã‚’è¶³ã™ã¨ã€x = 12 + 5 = 17 ã¨ãªã‚Šã¾ã™ã€‚" },
                    { q: "3x + 4 = 19 ã‚’è§£ããªã•ã„ã€‚", options: ["x = 5", "x = 6", "x = 4", "x = 3"], answer: 0, explanation: "ã¾ãšã€ä¸¡è¾ºã‹ã‚‰4ã‚’å¼•ãã¾ã™ã€‚3x = 19 - 4 = 15ã€‚æ¬¡ã«ã€ä¸¡è¾ºã‚’3ã§å‰²ã‚‹ã¨ã€x = 15 / 3 = 5 ã¨ãªã‚Šã¾ã™ã€‚" },
                    { q: "2(x + 3) = 14 ã‚’è§£ããªã•ã„ã€‚", options: ["x = 4", "x = 5", "x = 6", "x = 7"], answer: 0, explanation: "ã¾ãšã€åˆ†é…æ³•å‰‡ã‚’ä½¿ã£ã¦æ‹¬å¼§ã‚’å¤–ã—ã¾ã™ã€‚2x + 6 = 14ã€‚æ¬¡ã«ã€ä¸¡è¾ºã‹ã‚‰6ã‚’å¼•ãã¨ã€2x = 8ã€‚æœ€å¾Œã«ä¸¡è¾ºã‚’2ã§å‰²ã‚‹ã¨ã€x = 4 ã¨ãªã‚Šã¾ã™ã€‚" },
                    { q: "xã‚’æ¶ˆå»ã—ã¦yã«ã¤ã„ã¦è§£ããªã•ã„ã€‚\nx = y + 3\n2x + y = 12", options: ["y = 1", "y = 2", "y = 3", "y = 4"], answer: 1, explanation: "ä¸Šã®å¼ã‚’ä¸‹ã®å¼ã«ä»£å…¥ã—ã¾ã™ã€‚2(y + 3) + y = 12ã€‚åˆ†é…æ³•å‰‡ã§æ‹¬å¼§ã‚’å¤–ã—ã€2y + 6 + y = 12ã€‚æ•´ç†ã™ã‚‹ã¨ 3y + 6 = 12ã€‚ä¸¡è¾ºã‹ã‚‰6ã‚’å¼•ãã¨ 3y = 6ã€‚ä¸¡è¾ºã‚’3ã§å‰²ã‚‹ã¨ y = 2 ã¨ãªã‚Šã¾ã™ã€‚" },
                    { q: "æ¬¡ã®å¼ã‚’ç°¡å˜ã«ã—ãªã•ã„: 5a + 3b - 2a + 7b", options: ["3a + 10b", "7a + 10b", "3a + 4b", "7a + 4b"], answer: 0, explanation: "åŒé¡é …ã‚’ã¾ã¨ã‚ã¾ã™ã€‚aã®é …: 5a - 2a = 3aã€‚bã®é …: 3b + 7b = 10bã€‚ã—ãŸãŒã£ã¦ã€3a + 10b ã¨ãªã‚Šã¾ã™ã€‚" }
                ]
            },
            hi: {
                title: "â‘¡ æ¯”ã¨æ¯”ä¾‹ã®ç†è§£",
                questions: [
                    { q: "2 : 3 = x : 9 ã®ã¨ãã€xã®å€¤ã‚’æ±‚ã‚ãªã•ã„ã€‚", options: ["x = 6", "x = 8", "x = 10", "x = 12"], answer: 0, explanation: "æ¯”ã®å€¤ã¯ç­‰ã—ã„ã®ã§ã€2/3 = x/9 ã¨ãªã‚Šã¾ã™ã€‚ä¸¡è¾ºã«9ã‚’ã‹ã‘ã‚‹ã¨ x = (2/3) * 9 = 6 ã¨ãªã‚Šã¾ã™ã€‚ã¾ãŸã¯ã€å†…é …ã®ç©ã¨å¤–é …ã®ç©ãŒç­‰ã—ã„ã®ã§ã€3x = 2 * 9 = 18ã€‚ã‚ˆã£ã¦ x = 6 ã¨ãªã‚Šã¾ã™ã€‚" },
                    { q: "12å€‹ã®ãƒªãƒ³ã‚´ã‚’Aã•ã‚“ã¨Bã•ã‚“ã§2:1ã«åˆ†ã‘ã‚‹ã¨ãã€Aã•ã‚“ã¯ä½•å€‹ã‚‚ã‚‰ãˆã¾ã™ã‹ï¼Ÿ", options: ["4å€‹", "6å€‹", "8å€‹", "10å€‹"], answer: 2, explanation: "Aã•ã‚“ã¨Bã•ã‚“ã§åˆ†ã‘ã‚‹æ¯”ã¯2:1ãªã®ã§ã€å…¨ä½“ã®å‰²åˆã¯2+1=3ã¨ãªã‚Šã¾ã™ã€‚Aã•ã‚“ã®å‰²åˆã¯2/3ãªã®ã§ã€12å€‹ã®2/3ã¯ 12 * (2/3) = 8å€‹ ã¨ãªã‚Šã¾ã™ã€‚" },
                    { q: "yã¯xã«æ¯”ä¾‹ã—ã€x = 3 ã®ã¨ã y = 15 ã§ã™ã€‚æ¯”ä¾‹å®šæ•°ã‚’æ±‚ã‚ãªã•ã„ã€‚", options: ["3", "4", "5", "6"], answer: 2, explanation: "yã¯xã«æ¯”ä¾‹ã™ã‚‹ã®ã§ã€y = ax (aã¯æ¯”ä¾‹å®šæ•°) ã®é–¢ä¿‚ãŒã‚ã‚Šã¾ã™ã€‚x = 3, y = 15 ã‚’ä»£å…¥ã™ã‚‹ã¨ã€15 = a * 3 ã¨ãªã‚Šã€a = 15 / 3 = 5 ã¨ãªã‚Šã¾ã™ã€‚" },
                    { q: "yã¯xã«æ¯”ä¾‹ã—ã€x = 2 ã®ã¨ã y = 8 ã§ã™ã€‚y = 20 ã®ã¨ãã®xã®å€¤ã‚’æ±‚ã‚ãªã•ã„ã€‚", options: ["x = 4", "x = 5", "x = 6", "x = 7"], answer: 1, explanation: "ã¾ãšæ¯”ä¾‹å®šæ•°ã‚’æ±‚ã‚ã¾ã™ã€‚y = ax ã« x = 2, y = 8 ã‚’ä»£å…¥ã™ã‚‹ã¨ã€8 = a * 2 ãªã®ã§ a = 4ã€‚æ¯”ä¾‹ã®å¼ã¯ y = 4x ã¨ãªã‚Šã¾ã™ã€‚æ¬¡ã«ã€y = 20 ã‚’ä»£å…¥ã™ã‚‹ã¨ã€20 = 4x ã¨ãªã‚Šã€x = 20 / 4 = 5 ã¨ãªã‚Šã¾ã™ã€‚" },
                    { q: "Aã®é‡ãŒBã®é‡ã®3å€ã§ã‚ã‚‹ã¨ãã€Aã¨Bã®æ¯”ã‚’æœ€ã‚‚ç°¡å˜ãªæ•´æ•°æ¯”ã§è¡¨ã—ãªã•ã„ã€‚", options: ["1 : 3", "3 : 1", "2 : 3", "3 : 2"], answer: 1, explanation: "Bã®é‡ã‚’1ã¨ã™ã‚‹ã¨ã€Aã®é‡ã¯ãã®3å€ãªã®ã§3ã¨ãªã‚Šã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€A:B = 3:1 ã¨ãªã‚Šã¾ã™ã€‚" }
                ]
            },
            seisu: {
                title: "â‘¢ æ•´æ•°ã®æ€§è³ª",
                questions: [
                    { q: "18ã®æ­£ã®ç´„æ•°ã‚’ã™ã¹ã¦æŒ™ã’ãªã•ã„ã€‚", options: ["[1, 2, 3, 6, 9, 18]", "[1, 2, 3, 4, 9, 18]", "[1, 2, 6, 9, 18]", "[1, 3, 6, 9, 18]"], answer: 0, explanation: "ç´„æ•°ã¨ã¯ã€ãã®æ•°ã‚’å‰²ã‚Šåˆ‡ã‚‹ã“ã¨ãŒã§ãã‚‹æ•´æ•°ã§ã™ã€‚18ã‚’å‰²ã‚Šåˆ‡ã‚Œã‚‹æ•°ã¯ã€1, 2, 3, 6, 9, 18 ã§ã™ã€‚" },
                    { q: "24ã¨36ã®æœ€å¤§å…¬ç´„æ•°ã‚’æ±‚ã‚ãªã•ã„ã€‚", options: ["6", "8", "12", "18"], answer: 2, explanation: "24ã®ç´„æ•°: 1, 2, 3, 4, 6, 8, 12, 24ã€‚36ã®ç´„æ•°: 1, 2, 3, 4, 6, 9, 12, 18, 36ã€‚å…±é€šã™ã‚‹ç´„æ•°ã®ä¸­ã§æœ€ã‚‚å¤§ãã„ã®ã¯12ã§ã™ã€‚" },
                    { q: "6ã¨9ã®æœ€å°å…¬å€æ•°ã‚’æ±‚ã‚ãªã•ã„ã€‚", options: ["18", "36", "54", "6"], answer: 0, explanation: "6ã®å€æ•°: 6, 12, 18, 24, 30, ...ã€‚9ã®å€æ•°: 9, 18, 27, 36, ...ã€‚å…±é€šã™ã‚‹å€æ•°ã®ä¸­ã§æœ€ã‚‚å°ã•ã„ã®ã¯18ã§ã™ã€‚" },
                    { q: "ç´ æ•°ã§ã‚ã‚‹ã‚‚ã®ã‚’ã™ã¹ã¦é¸ã³ãªã•ã„: 1, 2, 9, 13, 21", options: ["[1, 2, 13]", "[2, 13]", "[2, 9, 13]", "[1, 2, 9, 13]"], answer: 1, explanation: "ç´ æ•°ã¨ã¯ã€1ã¨ãã®æ•°è‡ªèº«ä»¥å¤–ã«æ­£ã®ç´„æ•°ã‚’æŒãŸãªã„è‡ªç„¶æ•°ã§ã™ã€‚1ã¯ç´ æ•°ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚2ã¯å”¯ä¸€ã®å¶æ•°ã®ç´ æ•°ã§ã™ã€‚9ã¯3ã§å‰²ã‚Œã‚‹ã®ã§ç´ æ•°ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚13ã¯ç´ æ•°ã§ã™ã€‚21ã¯3ã¨7ã§å‰²ã‚Œã‚‹ã®ã§ç´ æ•°ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã—ãŸãŒã£ã¦ã€ç´ æ•°ã¯2ã¨13ã§ã™ã€‚" },
                    { q: "4ã§å‰²ã‚‹ã¨1ä½™ã‚‹æ•°ã‚’ã€æ•´æ•°nã‚’ä½¿ã£ã¦è¡¨ã—ãªã•ã„ã€‚", options: ["4n", "4n + 1", "4n - 1", "n + 4"], answer: 1, explanation: "4ã§å‰²ã‚Šåˆ‡ã‚Œã‚‹æ•°ã¯4nã¨è¡¨ã›ã¾ã™ã€‚ãã‚Œã«1ä½™ã‚‹ã¨ã„ã†ã“ã¨ã¯ã€4nã«1ã‚’è¶³ã›ã°ã‚ˆã„ã®ã§ã€4n + 1 ã¨ãªã‚Šã¾ã™ã€‚ (nã¯0ã¾ãŸã¯æ­£ã®æ•´æ•°)" }
                ]
            }
        };

        const categoryButtons = document.querySelectorAll('.category-button');
        const quizSection = document.getElementById('quiz-section');
        const quizTitle = document.getElementById('quiz-title');
        const currentQuestionElem = document.getElementById('current-question');
        const optionsArea = document.getElementById('options-area');
        const checkAnswerButton = document.getElementById('check-answer-btn');
        const nextQuestionOrRetryButton = document.getElementById('next-question-or-retry');
        const backToCategoriesButton = document.getElementById('back-to-categories');
        const resultMessage = document.getElementById('result-message');
        const explanationArea = document.getElementById('explanation-area');
        const finalMessage = document.getElementById('final-message');

        let currentCategory = '';
        let currentQuestionIndex = 0;
        let completedCategories = {}; // ã‚¯ãƒªã‚¢çŠ¶æ…‹ã¯localStorageã«ä¿å­˜ã›ãšã€ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®ã¿ãƒªã‚»ãƒƒãƒˆ

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’åˆæœŸåŒ–
        function initializeCategoryButtons() {
            Object.keys(categories).forEach(cat => {
                document.getElementById(`btn-${cat}`).classList.remove('completed');
            });
            completedCategories = {}; // å†…éƒ¨çŠ¶æ…‹ã‚‚ãƒªã‚»ãƒƒãƒˆ
            finalMessage.style.display = 'none'; // æœ€çµ‚ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚éè¡¨ç¤ºã«
            categoryButtons.forEach(button => {
                button.disabled = false; // ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
            });
        }
        initializeCategoryButtons(); // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«å®Ÿè¡Œ

        categoryButtons.forEach(button => {
            button.addEventListener('click', () => {
                // completedã‚¯ãƒ©ã‚¹ã¯ãƒšãƒ¼ã‚¸ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã§æ¶ˆãˆã‚‹ã®ã§ã€ã“ã®ãƒã‚§ãƒƒã‚¯ã¯ä¸è¦ã«ãªã‚‹
                // if (button.classList.contains('completed')) {
                //     alert('ã“ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼ã¯ã™ã§ã«ã‚¯ãƒªã‚¢æ¸ˆã¿ã§ã™ï¼');
                //     return;
                // }
                currentCategory = button.dataset.category;
                currentQuestionIndex = 0;
                showQuizSection();
                loadQuestion();
            });
        });

        checkAnswerButton.addEventListener('click', () => {
            checkAnswer();
        });

        nextQuestionOrRetryButton.addEventListener('click', () => {
            if (resultMessage.textContent.includes('æ®‹å¿µï¼')) {
                // ä¸æ­£è§£ã ã£ãŸã®ã§æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—
                currentQuestionIndex = 0;
                resultMessage.textContent = '';
                explanationArea.style.display = 'none';
                loadQuestion();
            } else {
                // æ­£è§£ã ã£ãŸã®ã§æ¬¡ã®å•é¡Œã¸
                currentQuestionIndex++;
                resultMessage.textContent = '';
                explanationArea.style.display = 'none';
                if (currentQuestionIndex < categories[currentCategory].questions.length) {
                    loadQuestion();
                } else {
                    // å…¨å•æ­£è§£
                    markCategoryCompleted();
                }
            }
        });


        backToCategoriesButton.addEventListener('click', () => {
            quizSection.style.display = 'none';
            document.querySelector('.category-buttons').style.display = 'flex';
            resultMessage.textContent = '';
            explanationArea.style.display = 'none';
        });

        function showQuizSection() {
            document.querySelector('.category-buttons').style.display = 'none';
            quizSection.style.display = 'block';
            resultMessage.textContent = '';
            explanationArea.style.display = 'none';
            quizTitle.textContent = categories[currentCategory].title;
            checkAnswerButton.style.display = 'inline-block';
            nextQuestionOrRetryButton.style.display = 'none';
        }

        function loadQuestion() {
            const questionData = categories[currentCategory].questions[currentQuestionIndex];
            currentQuestionElem.textContent = `Q${currentQuestionIndex + 1}. ${questionData.q}`;
            optionsArea.innerHTML = '';

            questionData.options.forEach((option, index) => {
                const label = document.createElement('label');
                const radio = document.createElement('input');
                radio.type = 'radio';
                radio.name = 'quiz-option';
                radio.value = index;
                label.appendChild(radio);
                label.appendChild(document.createTextNode(option));
                optionsArea.appendChild(label);
            });

            checkAnswerButton.style.display = 'inline-block';
            nextQuestionOrRetryButton.style.display = 'none';
            resultMessage.textContent = '';
            explanationArea.style.display = 'none';

            document.querySelectorAll('input[name="quiz-option"]').forEach(radio => radio.checked = false);
        }

        function checkAnswer() {
            const selectedOption = document.querySelector('input[name="quiz-option"]:checked');
            const questionData = categories[currentCategory].questions[currentQuestionIndex];

            if (!selectedOption) {
                alert('é¸æŠè‚¢ã‚’é¸ã‚“ã§ãã ã•ã„ï¼');
                return;
            }

            const isCorrect = parseInt(selectedOption.value) === questionData.answer;

            explanationArea.innerHTML = `<strong>è§£èª¬:</strong><br>${questionData.explanation}`;
            explanationArea.style.display = 'block';

            if (isCorrect) {
                resultMessage.textContent = 'æ­£è§£ï¼ç´ æ™´ã‚‰ã—ã„ï¼âœ¨';
                nextQuestionOrRetryButton.textContent = 'æ¬¡ã®å•é¡Œã¸';
            } else {
                resultMessage.textContent = 'æ®‹å¿µï¼ã‚‚ã†ä¸€åº¦æŒ‘æˆ¦ã—ã‚ˆã†ï¼ğŸ’¦ (ã“ã®ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã—)';
                nextQuestionOrRetryButton.textContent = 'æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™';
            }

            checkAnswerButton.style.display = 'none';
            nextQuestionOrRetryButton.style.display = 'inline-block';
        }

        function markCategoryCompleted() {
            resultMessage.textContent = 'å…¨å•æ­£è§£ï¼ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ğŸ‰';
            document.getElementById(`btn-${currentCategory}`).classList.add('completed');
            completedCategories[currentCategory] = true; // å†…éƒ¨çŠ¶æ…‹ã¯æ›´æ–°
            // localStorage.setItem('completedCategories', JSON.stringify(completedCategories)); // â˜…ã“ã®è¡Œã‚’å‰Šé™¤
            nextQuestionOrRetryButton.style.display = 'none';
            checkAllCategoriesCompleted();
        }

        function checkAllCategoriesCompleted() {
            const allCompleted = Object.keys(categories).every(cat => completedCategories[cat]);
            if (allCompleted) {
                finalMessage.style.display = 'block';
                categoryButtons.forEach(button => {
                    button.disabled = true;
                });
            } else {
                finalMessage.style.display = 'none';
                categoryButtons.forEach(button => {
                    // ã‚¯ãƒªã‚¢æ¸ˆã¿ã®ãƒœã‚¿ãƒ³ã¯ç„¡åŠ¹åŒ–ã€æœªã‚¯ãƒªã‚¢ã®ãƒœã‚¿ãƒ³ã¯æœ‰åŠ¹åŒ–ï¼ˆãŸã ã—completedã‚¯ãƒ©ã‚¹ã¯æ®‹ã™ï¼‰
                    // ãƒšãƒ¼ã‚¸ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã§å…¨ã¦ãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹ãŸã‚ã€disabledçŠ¶æ…‹ã®åˆ¶å¾¡ã¯ä¸è¦ã ãŒã€å¿µã®ãŸã‚
                    button.disabled = button.classList.contains('completed');
                });
            }
        }

        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®åˆæœŸåŒ–ã¯initializeCategoryButtons()ã§å®Ÿæ–½æ¸ˆã¿
        // checkAllCategoriesCompleted();
    </script>
</body>
</html>